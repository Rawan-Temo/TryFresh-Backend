"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[982],{9293:(e,t,a)=>{a.r(t),a.d(t,{default:()=>R});var i=a(8261),r=a(3248),s=a(7097),n=a(5043),l=a(2970),o=a(7562),d=a(156),c=a(9193),u=a(6046),h=a(5679),m=a(6963),p=a(3892),g=a(4061),v=a(579);const x=e=>{let{filters:t,setFilters:a}=e;const i=(0,p.Wx)({initialValues:t});return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(m.A,{children:(0,v.jsx)(g.A,{title:"test filter"})}),(0,v.jsxs)(m.A,{children:[(0,v.jsx)(g.A,{title:"test filter"}),(0,v.jsx)(g.A,{title:"test filter"}),(0,v.jsx)(g.A,{title:"test filter"})]}),(0,v.jsx)(h.A,{values:i.values,resetForm:i.resetForm,setFilters:a})]})};var f=a(899),P=a(4263),y=a(2555),j=a(3986),b=a(2574),A=a(28),C=class extends b.${constructor(e,t){super(e,t)}bindMethods(){super.bindMethods(),this.fetchNextPage=this.fetchNextPage.bind(this),this.fetchPreviousPage=this.fetchPreviousPage.bind(this)}setOptions(e){super.setOptions((0,y.A)((0,y.A)({},e),{},{behavior:(0,A.PL)()}))}getOptimisticResult(e){return e.behavior=(0,A.PL)(),super.getOptimisticResult(e)}fetchNextPage(e){return this.fetch((0,y.A)((0,y.A)({},e),{},{meta:{fetchMore:{direction:"forward"}}}))}fetchPreviousPage(e){return this.fetch((0,y.A)((0,y.A)({},e),{},{meta:{fetchMore:{direction:"backward"}}}))}createResult(e,t){var a;const{state:i}=e,r=super.createResult(e,t),{isFetching:s,isRefetching:n,isError:l,isRefetchError:o}=r,d=null===(a=i.fetchMeta)||void 0===a||null===(a=a.fetchMore)||void 0===a?void 0:a.direction,c=l&&"forward"===d,u=s&&"forward"===d,h=l&&"backward"===d,m=s&&"backward"===d;return(0,y.A)((0,y.A)({},r),{},{fetchNextPage:this.fetchNextPage,fetchPreviousPage:this.fetchPreviousPage,hasNextPage:(0,A.rB)(t,i.data),hasPreviousPage:(0,A.RQ)(t,i.data),isFetchNextPageError:c,isFetchingNextPage:u,isFetchPreviousPageError:h,isFetchingPreviousPage:m,isRefetchError:o&&!c&&!h,isRefetching:n&&!u&&!m})}},N=a(9836);var w=a(6721);const k=["placeholder","label","optionLabel","onChange","onIgnore","value","endPoint","queryKey","isArray","errorText","delay"],I=e=>{var t;let{placeholder:a,label:i,optionLabel:r,onChange:s,onIgnore:o,value:d,endPoint:u,queryKey:h,isArray:m,errorText:p,delay:g=500}=e,x=(0,j.A)(e,k);const f=new c.A(u),[P,b]=(0,n.useState)(!1),[A,I]=(0,n.useState)(""),[F]=(0,l.d7)(A,g),S=(0,n.useRef)(null),{data:q,fetchNextPage:R,isFetching:E,hasNextPage:T}=(L={queryKey:[h,F],queryFn:e=>{let{pageParam:t}=e;return f.getAll({page:t,limit:3,search:F})},initialPageParam:1,getNextPageParam:(e,t)=>e.data.length>0?t.length+1:void 0},(0,N.t)(L,C,O));var L,O;const K=null===q||void 0===q||null===(t=q.pages)||void 0===t?void 0:t.flatMap(e=>e.data),M=(0,n.useCallback)(e=>{E||(S.current&&S.current.disconnect(),S.current=new IntersectionObserver(e=>{e[0].isIntersecting&&T&&R()},{threshold:1}),e&&S.current.observe(e))},[E,T,R]),D=(0,n.useCallback)(e=>{e.stopPropagation(),b(e=>!e)},[]),U=(0,n.useCallback)(e=>{e.stopPropagation()},[]);return(0,n.useEffect)(()=>{const e=()=>{P&&b(!1)};return window.addEventListener("click",e),()=>{window.removeEventListener("click",e)}},[P]),(0,v.jsxs)("div",{className:"select-input",children:[i&&(0,v.jsx)("label",{className:"title",onClick:D,children:i}),(0,v.jsxs)("div",(0,y.A)((0,y.A)({},x),{},{children:[(0,v.jsxs)("div",{onClick:D,children:[a," ",(0,v.jsx)("i",{className:"fa-solid fa-chevron-down"})]}),(0,v.jsxs)("article",{className:P?"active":"",children:[(0,v.jsxs)("label",{htmlFor:"search",onClick:U,children:[(0,v.jsx)("input",{value:A,onChange:e=>{I(e.target.value.toLowerCase())},placeholder:"search ...",id:"search"}),(0,v.jsx)("i",{className:"fa-solid fa-magnifying-glass"})]}),null===K||void 0===K?void 0:K.map((e,t)=>(0,v.jsx)("h3",{onClick:()=>{s(e)},ref:t===(null===K||void 0===K?void 0:K.length)-1?M:null,children:r(e)},e._id)),E&&(0,v.jsx)("p",{children:"loading..."}),!T&&!E&&(0,v.jsx)("p",{children:"no more data"})]})]})),m&&(null===d||void 0===d?void 0:d.length)>0?(0,v.jsx)("div",{className:"array-of-values",children:null===d||void 0===d?void 0:d.map((e,t)=>(0,v.jsx)(w.A,{onClick:()=>o(e),btnStyleType:"outlined",btnType:"delete",children:"string"===typeof e?e:r(e)},e._id||t))}):!m&&d&&(0,v.jsx)(w.A,{onClick:o,btnStyleType:"outlined",btnType:"delete",children:d}),p&&(0,v.jsx)("p",{className:"color-red",children:p})]})};var F=a(4473);const S=[{name:"image",headerName:"Image",getCell:e=>{let{row:t}=e;return t.image?(0,v.jsx)("img",{src:t.image.startsWith("http")?t.image:"".concat(F.b).concat(t.image),alt:t.name,style:{width:"60px",height:"60px",objectFit:"cover",borderRadius:"8px"}}):"\u2014"}},{name:"name",headerName:"Name",sort:!0},{name:"price",headerName:"Price",sort:!0},{name:"typeId",headerName:"Type",getCell:e=>{var t;let{row:a}=e;return(null===a||void 0===a||null===(t=a.typeId)||void 0===t?void 0:t.name)||"\u2014"}},{name:"createdAt",headerName:"Created At",getCell:e=>{let{row:t,isCustomPopUpOpen:a,setIsCustomPopUpOpen:i}=e;return a?(0,v.jsx)(o.A,{isOpen:a,onClose:()=>i(!1),children:(0,v.jsx)("p",{children:(0,d.A)(t.createdAt,"fullDate")})}):(0,v.jsx)("p",{onClick:()=>i(!0),children:(0,d.A)(t.createdAt,"justYear")})},sort:!0},{name:"option",headerName:"Options",getCell:e=>{let{row:t,setSelectedItems:a,setIsPopUpOpen:i,returnRow:r}=e;return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("i",{onClick:()=>{i(!0),a(new Set([t._id]))},className:"fa-solid fa-trash-can",title:"delete"}),(0,v.jsx)("i",{className:"fa-solid fa-pen-to-square icon-edit",title:"update",onClick:()=>r(t)})]})}}],q=new c.A("items"),R=()=>{var e;const[t,a]=(0,n.useState)(1),[o,d]=(0,n.useState)({}),[c,h]=(0,n.useState)(new Set),[m,y]=(0,n.useState)({from:"",to:"",createdBy:""}),[j,b]=(0,n.useState)(""),[A]=(0,l.d7)(j,1e3),C=(0,n.useMemo)(()=>["items",t,o,m,A],[t,o,m,A]),{data:N,isLoading:w}=(0,i.I)({queryKey:C,queryFn:()=>q.getAll({page:t,sort:o,filters:m,limit:100,search:j}),keepPreviousData:!0}),k=(0,r.jE)(),[R,E]=(0,n.useState)(null),T=(0,s.n)({mutationKey:C,mutationFn:e=>q.addData({data:e})}),L=(0,s.n)({mutationKey:C,mutationFn:e=>q.updateData({id:null===R||void 0===R?void 0:R._id,data:e})}),O=(0,p.Wx)({enableReinitialize:!0,initialValues:{name:(null===R||void 0===R?void 0:R.name)||"",price:(null===R||void 0===R?void 0:R.price)||"",typeId:(null===R||void 0===R?void 0:R.typeId)||null,image:null,previewImage:(null===R||void 0===R?void 0:R.image)&&(null!==R&&void 0!==R&&R.image.startsWith("http")?null===R||void 0===R?void 0:R.image:"".concat(F.b).concat(null===R||void 0===R?void 0:R.image))},validationSchema:f.Ik({name:f.Yj().required("Name is required"),price:f.Yj().required("Price is required"),typeId:f.gl().required("Type is required")}),onSubmit:e=>{(R?L:T).mutate(e,{onSuccess:()=>{O.resetForm(),k.invalidateQueries({queryKey:["items"]}),E(!1)}})}}),K=(0,n.useCallback)(()=>{E(!1),O.resetForm()},[O]);return(0,v.jsxs)("div",{className:"table-with-form-container",children:[(0,v.jsxs)(P.A,{onSubmit:O.handleSubmit,buttonProps:{isSending:T.isPending||L.isPending},header:R?"\u062a\u062d\u062f\u064a\u062b \u0645\u0646\u062a\u062c":"\u0627\u0636\u0627\u0641\u0629 \u0645\u0646\u062a\u062c \u062c\u062f\u064a\u062f",isUpdate:R,oncancel:K,children:[(0,v.jsx)(I,{label:"Type",placeholder:"Select a type...",endPoint:"types",queryKey:"types",optionLabel:e=>e.name,value:null===(e=O.values.typeId)||void 0===e?void 0:e.name,onChange:e=>O.setFieldValue("typeId",e),onIgnore:()=>O.setFieldValue("typeId",null),errorText:O.touched.typeId&&O.errors.typeId}),(0,v.jsx)(g.A,{placeholder:"Enter name",title:"Name",name:"name",value:O.values.name,onChange:O.handleChange,errorText:O.touched.name&&O.errors.name}),(0,v.jsx)(g.A,{placeholder:"Enter price",title:"Price",name:"price",value:O.values.price,onChange:O.handleChange,errorText:O.touched.price&&O.errors.price})]}),(0,v.jsx)(u.A,{colmuns:S,loading:w,currentPage:t,setPage:a,data:null===N||void 0===N?void 0:N.data,dataLength:null===N||void 0===N?void 0:N.totalCount,setSort:d,selectedItems:c,setSelectedItems:h,delelteEndPoint:"items",queryKey:"items",heading:"\u0627\u0644\u0645\u0646\u062a\u062c\u0627\u062a",setSearch:b,returnRow:E,selectable:!0,children:(0,v.jsx)(x,{filters:m,setFilters:y})})]})}}}]);
//# sourceMappingURL=982.83a61937.chunk.js.map